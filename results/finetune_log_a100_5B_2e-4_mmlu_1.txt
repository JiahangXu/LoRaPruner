prompt_mark 1
{'data_dir': 'data/mmlu', 'ntrain': 5, 'prompt_mark': 1, 'kwargs': {'model_name': 'llama', 'model_path': 'a100_updatetokenizer_mark28-2_LoRaApplyAll_lr2e-4_bs8_AlpacaGPT4'}, 'args': Namespace(data_dir='data/mmlu', ntrain=5, prompt_mark=1, kwargs={'model_name': 'llama', 'model_path': 'a100_updatetokenizer_mark28-2_LoRaApplyAll_lr2e-4_bs8_AlpacaGPT4'}), 'model': LlamaModel(model_path='a100_updatetokenizer_mark28-2_LoRaApplyAll_lr2e-4_bs8_AlpacaGPT4', max_input_length=2048, max_output_length=2, model=None, tokenizer=None, lora_path='', device='cuda', load_8bit=False, do_sample=False, use_template=False)}

  0%|          | 0/57 [00:00<?, ?it/s]/home/aisilicon/miniconda3/envs/llm-pruner/lib/python3.10/site-packages/transformers/tokenization_utils_base.py:1900: FutureWarning: The `use_auth_token` argument is deprecated and will be removed in v5 of Transformers. Please use `token` instead.
  warnings.warn(


Loading checkpoint shards:   0%|          | 0/6 [00:00<?, ?it/s][A

Loading checkpoint shards:  17%|█▋        | 1/6 [00:01<00:06,  1.27s/it][A

Loading checkpoint shards:  33%|███▎      | 2/6 [00:02<00:05,  1.26s/it][A

Loading checkpoint shards:  50%|█████     | 3/6 [00:03<00:03,  1.28s/it][A

Loading checkpoint shards:  67%|██████▋   | 4/6 [00:05<00:02,  1.28s/it][A

Loading checkpoint shards:  83%|████████▎ | 5/6 [00:06<00:01,  1.27s/it][A

Loading checkpoint shards: 100%|██████████| 6/6 [00:07<00:00,  1.06s/it][A
Loading checkpoint shards: 100%|██████████| 6/6 [00:07<00:00,  1.17s/it]

  2%|▏         | 1/57 [01:29<1:23:41, 89.67s/it]
  4%|▎         | 2/57 [02:54<1:19:29, 86.72s/it]
  5%|▌         | 3/57 [05:19<1:42:03, 113.40s/it]
  7%|▋         | 4/57 [06:53<1:33:34, 105.93s/it]
  9%|▉         | 5/57 [10:00<1:57:05, 135.12s/it]
 11%|█         | 6/57 [11:52<1:48:11, 127.28s/it]
 12%|█▏        | 7/57 [13:20<1:35:10, 114.21s/it]
 14%|█▍        | 8/57 [15:27<1:36:45, 118.48s/it]
 16%|█▌        | 9/57 [16:58<1:27:44, 109.68s/it]
 18%|█▊        | 10/57 [19:26<1:35:11, 121.52s/it]
 19%|█▉        | 11/57 [20:44<1:23:05, 108.37s/it]
 21%|██        | 12/57 [21:47<1:10:55, 94.56s/it] 
 23%|██▎       | 13/57 [23:58<1:17:22, 105.51s/it]
 25%|██▍       | 14/57 [25:45<1:15:58, 106.00s/it]
 26%|██▋       | 15/57 [27:26<1:13:09, 104.52s/it]
 28%|██▊       | 16/57 [32:45<1:55:31, 169.06s/it]
 30%|██▉       | 17/57 [34:44<1:42:43, 154.09s/it]
 32%|███▏      | 18/57 [35:54<1:23:34, 128.58s/it]
 33%|███▎      | 19/57 [40:13<1:46:24, 168.02s/it]
 35%|███▌      | 20/57 [42:57<1:42:46, 166.66s/it]
 37%|███▋      | 21/57 [45:15<1:34:47, 157.98s/it]
 39%|███▊      | 22/57 [51:36<2:11:13, 224.96s/it]
 40%|████      | 23/57 [53:49<1:51:56, 197.55s/it]
 42%|████▏     | 24/57 [56:14<1:39:56, 181.72s/it]
 44%|████▍     | 25/57 [1:00:39<1:50:16, 206.77s/it]
 46%|████▌     | 26/57 [1:04:25<1:49:40, 212.28s/it]
 47%|████▋     | 27/57 [1:07:08<1:38:44, 197.49s/it]
 49%|████▉     | 28/57 [1:09:21<1:26:06, 178.14s/it]
 51%|█████     | 29/57 [1:17:01<2:02:40, 262.86s/it]
 53%|█████▎    | 30/57 [1:21:41<2:00:34, 267.95s/it]
 54%|█████▍    | 31/57 [1:30:02<2:26:24, 337.87s/it]
 56%|█████▌    | 32/57 [1:39:28<2:49:16, 406.24s/it]
 58%|█████▊    | 33/57 [1:41:39<2:09:32, 323.83s/it]
 60%|█████▉    | 34/57 [1:43:01<1:36:20, 251.31s/it]
 61%|██████▏   | 35/57 [1:45:06<1:18:14, 213.41s/it]
 63%|██████▎   | 36/57 [1:46:20<1:00:01, 171.49s/it]
 65%|██████▍   | 37/57 [1:48:19<51:52, 155.65s/it]  
 67%|██████▋   | 38/57 [1:50:15<45:34, 143.94s/it]
 68%|██████▊   | 39/57 [1:51:13<35:27, 118.20s/it]
 70%|███████   | 40/57 [1:53:56<37:16, 131.55s/it]
 72%|███████▏  | 41/57 [1:54:59<29:33, 110.85s/it]
 74%|███████▎  | 42/57 [2:02:30<53:13, 212.88s/it]
 75%|███████▌  | 43/57 [2:06:54<53:14, 228.18s/it]
 77%|███████▋  | 44/57 [2:22:30<1:35:28, 440.68s/it]
 79%|███████▉  | 45/57 [2:27:30<1:19:42, 398.52s/it]
 81%|████████  | 46/57 [2:30:37<1:01:25, 335.03s/it]
 82%|████████▏ | 47/57 [2:35:21<53:16, 319.65s/it]  
 84%|████████▍ | 48/57 [2:40:49<48:19, 322.17s/it]
 86%|████████▌ | 49/57 [3:39:30<2:50:55, 1281.95s/it]
 88%|████████▊ | 50/57 [3:47:53<2:02:16, 1048.03s/it]
 89%|████████▉ | 51/57 [3:56:58<1:29:42, 897.17s/it] 
 91%|█████████ | 52/57 [3:58:13<54:13, 650.67s/it]  
 93%|█████████▎| 53/57 [4:06:10<39:54, 598.65s/it]
 95%|█████████▍| 54/57 [4:08:38<23:09, 463.24s/it]
 96%|█████████▋| 55/57 [4:09:49<11:31, 345.57s/it]
 98%|█████████▊| 56/57 [4:11:33<04:33, 273.11s/it]
100%|██████████| 57/57 [4:13:07<00:00, 219.35s/it]
100%|██████████| 57/57 [4:13:07<00:00, 266.44s/it]
Average accuracy 0.290 - abstract_algebra
Average accuracy 0.363 - anatomy
Average accuracy 0.243 - astronomy
Average accuracy 0.260 - business_ethics
Average accuracy 0.328 - clinical_knowledge
Average accuracy 0.292 - college_biology
Average accuracy 0.220 - college_chemistry
Average accuracy 0.320 - college_computer_science
Average accuracy 0.210 - college_mathematics
Average accuracy 0.237 - college_medicine
Average accuracy 0.284 - college_physics
Average accuracy 0.290 - computer_security
Average accuracy 0.345 - conceptual_physics
Average accuracy 0.254 - econometrics
Average accuracy 0.283 - electrical_engineering
Average accuracy 0.275 - elementary_mathematics
Average accuracy 0.325 - formal_logic
Average accuracy 0.290 - global_facts
Average accuracy 0.339 - high_school_biology
Average accuracy 0.281 - high_school_chemistry
Average accuracy 0.300 - high_school_computer_science
Average accuracy 0.267 - high_school_european_history
Average accuracy 0.278 - high_school_geography
Average accuracy 0.337 - high_school_government_and_politics
Average accuracy 0.318 - high_school_macroeconomics
Average accuracy 0.293 - high_school_mathematics
Average accuracy 0.290 - high_school_microeconomics
Average accuracy 0.278 - high_school_physics
Average accuracy 0.317 - high_school_psychology
Average accuracy 0.324 - high_school_statistics
Average accuracy 0.304 - high_school_us_history
Average accuracy 0.321 - high_school_world_history
Average accuracy 0.386 - human_aging
Average accuracy 0.336 - human_sexuality
Average accuracy 0.545 - international_law
Average accuracy 0.352 - jurisprudence
Average accuracy 0.325 - logical_fallacies
Average accuracy 0.232 - machine_learning
Average accuracy 0.359 - management
Average accuracy 0.363 - marketing
Average accuracy 0.280 - medical_genetics
Average accuracy 0.392 - miscellaneous
Average accuracy 0.301 - moral_disputes
Average accuracy 0.231 - moral_scenarios
Average accuracy 0.382 - nutrition
Average accuracy 0.322 - philosophy
Average accuracy 0.296 - prehistory
Average accuracy 0.294 - professional_accounting
Average accuracy 0.265 - professional_law
Average accuracy 0.309 - professional_medicine
Average accuracy 0.291 - professional_psychology
Average accuracy 0.409 - public_relations
Average accuracy 0.367 - security_studies
Average accuracy 0.433 - sociology
Average accuracy 0.370 - us_foreign_policy
Average accuracy 0.361 - virology
Average accuracy 0.281 - world_religions
Average accuracy 0.285 - math
Average accuracy 0.337 - health
Average accuracy 0.295 - physics
Average accuracy 0.339 - business
Average accuracy 0.324 - biology
Average accuracy 0.261 - chemistry
Average accuracy 0.284 - computer science
Average accuracy 0.299 - economics
Average accuracy 0.283 - engineering
Average accuracy 0.275 - philosophy
Average accuracy 0.360 - other
Average accuracy 0.299 - history
Average accuracy 0.278 - geography
Average accuracy 0.366 - politics
Average accuracy 0.303 - psychology
Average accuracy 0.395 - culture
Average accuracy 0.289 - law
------------
Average accuracy 0.290 - STEM
Average accuracy 0.285 - humanities
Average accuracy 0.324 - social sciences
Average accuracy 0.345 - other (business, health, misc.)
Average accuracy: 0.309
{'mmlu': 30.85}
mmlu: 30.85
