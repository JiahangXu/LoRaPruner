prompt_mark 1
{'data_dir': 'data/mmlu', 'ntrain': 5, 'prompt_mark': 1, 'kwargs': {'model_name': 'llama', 'model_path': './a100_updatetokenizer_mark25_LoRaApplyAll_lr1e-4_bs8_AlpacaGPT4'}, 'args': Namespace(data_dir='data/mmlu', ntrain=5, prompt_mark=1, kwargs={'model_name': 'llama', 'model_path': './a100_updatetokenizer_mark25_LoRaApplyAll_lr1e-4_bs8_AlpacaGPT4'}), 'model': LlamaModel(model_path='./a100_updatetokenizer_mark25_LoRaApplyAll_lr1e-4_bs8_AlpacaGPT4', max_input_length=2048, max_output_length=2, model=None, tokenizer=None, lora_path='', device='cuda', load_8bit=False, do_sample=False, use_template=False)}

  0%|          | 0/57 [00:00<?, ?it/s]/home/aisilicon/miniconda3/envs/llm-pruner/lib/python3.10/site-packages/transformers/tokenization_utils_base.py:1900: FutureWarning: The `use_auth_token` argument is deprecated and will be removed in v5 of Transformers. Please use `token` instead.
  warnings.warn(


Loading checkpoint shards:   0%|          | 0/6 [00:00<?, ?it/s][A

Loading checkpoint shards:  17%|█▋        | 1/6 [00:01<00:06,  1.35s/it][A

Loading checkpoint shards:  33%|███▎      | 2/6 [00:02<00:05,  1.33s/it][A

Loading checkpoint shards:  50%|█████     | 3/6 [00:04<00:04,  1.46s/it][A

Loading checkpoint shards:  67%|██████▋   | 4/6 [00:05<00:02,  1.42s/it][A

Loading checkpoint shards:  83%|████████▎ | 5/6 [00:06<00:01,  1.36s/it][A

Loading checkpoint shards: 100%|██████████| 6/6 [00:07<00:00,  1.12s/it][A
Loading checkpoint shards: 100%|██████████| 6/6 [00:07<00:00,  1.26s/it]

  2%|▏         | 1/57 [01:08<1:04:00, 68.57s/it]
  4%|▎         | 2/57 [01:49<48:11, 52.58s/it]  
  5%|▌         | 3/57 [03:01<54:58, 61.09s/it]
  7%|▋         | 4/57 [03:45<48:12, 54.58s/it]
  9%|▉         | 5/57 [05:13<57:41, 66.56s/it]
 11%|█         | 6/57 [06:06<52:34, 61.85s/it]
 12%|█▏        | 7/57 [06:46<45:41, 54.83s/it]
 14%|█▍        | 8/57 [07:47<46:21, 56.76s/it]
 16%|█▌        | 9/57 [08:29<41:49, 52.28s/it]
 18%|█▊        | 10/57 [09:40<45:23, 57.95s/it]
 19%|█▉        | 11/57 [10:18<39:40, 51.75s/it]
 21%|██        | 12/57 [10:48<33:54, 45.21s/it]
 23%|██▎       | 13/57 [11:51<37:03, 50.53s/it]
 25%|██▍       | 14/57 [12:41<36:13, 50.54s/it]
 26%|██▋       | 15/57 [13:30<34:58, 49.95s/it]
 28%|██▊       | 16/57 [16:04<55:34, 81.34s/it]
 30%|██▉       | 17/57 [17:02<49:26, 74.17s/it]
 32%|███▏      | 18/57 [17:35<40:12, 61.86s/it]
 33%|███▎      | 19/57 [19:39<51:01, 80.57s/it]
 35%|███▌      | 20/57 [20:56<48:57, 79.38s/it]
 37%|███▋      | 21/57 [22:01<45:03, 75.10s/it]
 39%|███▊      | 22/57 [25:08<1:03:27, 108.78s/it]
 40%|████      | 23/57 [26:11<53:45, 94.86s/it]   
 42%|████▏     | 24/57 [27:18<47:42, 86.76s/it]
 44%|████▍     | 25/57 [29:22<52:12, 97.88s/it]
 46%|████▌     | 26/57 [31:08<51:46, 100.20s/it]
 47%|████▋     | 27/57 [32:24<46:28, 92.96s/it] 
 49%|████▉     | 28/57 [33:26<40:30, 83.82s/it]
 51%|█████     | 29/57 [37:04<57:48, 123.88s/it]
 53%|█████▎    | 30/57 [39:16<56:56, 126.52s/it]
 54%|█████▍    | 31/57 [43:23<1:10:25, 162.50s/it]
 56%|█████▌    | 32/57 [47:51<1:20:53, 194.13s/it]
 58%|█████▊    | 33/57 [48:52<1:01:45, 154.38s/it]
 60%|█████▉    | 34/57 [49:31<45:53, 119.70s/it]  
 61%|██████▏   | 35/57 [50:31<37:16, 101.68s/it]
 63%|██████▎   | 36/57 [51:05<28:31, 81.51s/it] 
 65%|██████▍   | 37/57 [52:00<24:27, 73.37s/it]
 67%|██████▋   | 38/57 [52:54<21:23, 67.56s/it]
 68%|██████▊   | 39/57 [53:20<16:34, 55.26s/it]
 70%|███████   | 40/57 [54:17<15:45, 55.65s/it]
 72%|███████▏  | 41/57 [54:30<11:27, 43.00s/it]
 74%|███████▎  | 42/57 [57:45<22:08, 88.57s/it]
 75%|███████▌  | 43/57 [59:59<23:50, 102.18s/it]
 77%|███████▋  | 44/57 [1:07:48<45:57, 212.12s/it]
 79%|███████▉  | 45/57 [1:10:21<38:53, 194.43s/it]
 81%|████████  | 46/57 [1:11:55<30:06, 164.26s/it]
 82%|████████▏ | 47/57 [1:14:19<26:22, 158.23s/it]
 84%|████████▍ | 48/57 [1:17:07<24:10, 161.16s/it]
 86%|████████▌ | 49/57 [1:45:50<1:23:58, 629.79s/it]
 88%|████████▊ | 50/57 [1:50:00<1:00:09, 515.71s/it]
 89%|████████▉ | 51/57 [1:54:27<44:06, 441.04s/it]  
 91%|█████████ | 52/57 [1:55:04<26:40, 320.06s/it]
 93%|█████████▎| 53/57 [1:59:05<19:45, 296.26s/it]
 95%|█████████▍| 54/57 [2:00:17<11:27, 229.07s/it]
 96%|█████████▋| 55/57 [2:00:52<05:41, 170.89s/it]
 98%|█████████▊| 56/57 [2:01:44<02:15, 135.05s/it]
100%|██████████| 57/57 [2:02:23<00:00, 106.15s/it]
100%|██████████| 57/57 [2:02:23<00:00, 128.83s/it]
Average accuracy 0.330 - abstract_algebra
Average accuracy 0.422 - anatomy
Average accuracy 0.322 - astronomy
Average accuracy 0.470 - business_ethics
Average accuracy 0.374 - clinical_knowledge
Average accuracy 0.361 - college_biology
Average accuracy 0.320 - college_chemistry
Average accuracy 0.360 - college_computer_science
Average accuracy 0.320 - college_mathematics
Average accuracy 0.312 - college_medicine
Average accuracy 0.235 - college_physics
Average accuracy 0.490 - computer_security
Average accuracy 0.366 - conceptual_physics
Average accuracy 0.307 - econometrics
Average accuracy 0.407 - electrical_engineering
Average accuracy 0.272 - elementary_mathematics
Average accuracy 0.222 - formal_logic
Average accuracy 0.320 - global_facts
Average accuracy 0.374 - high_school_biology
Average accuracy 0.217 - high_school_chemistry
Average accuracy 0.430 - high_school_computer_science
Average accuracy 0.455 - high_school_european_history
Average accuracy 0.399 - high_school_geography
Average accuracy 0.487 - high_school_government_and_politics
Average accuracy 0.328 - high_school_macroeconomics
Average accuracy 0.256 - high_school_mathematics
Average accuracy 0.324 - high_school_microeconomics
Average accuracy 0.238 - high_school_physics
Average accuracy 0.494 - high_school_psychology
Average accuracy 0.278 - high_school_statistics
Average accuracy 0.407 - high_school_us_history
Average accuracy 0.481 - high_school_world_history
Average accuracy 0.439 - human_aging
Average accuracy 0.397 - human_sexuality
Average accuracy 0.537 - international_law
Average accuracy 0.472 - jurisprudence
Average accuracy 0.429 - logical_fallacies
Average accuracy 0.348 - machine_learning
Average accuracy 0.379 - management
Average accuracy 0.641 - marketing
Average accuracy 0.390 - medical_genetics
Average accuracy 0.508 - miscellaneous
Average accuracy 0.347 - moral_disputes
Average accuracy 0.263 - moral_scenarios
Average accuracy 0.386 - nutrition
Average accuracy 0.408 - philosophy
Average accuracy 0.383 - prehistory
Average accuracy 0.319 - professional_accounting
Average accuracy 0.292 - professional_law
Average accuracy 0.375 - professional_medicine
Average accuracy 0.382 - professional_psychology
Average accuracy 0.382 - public_relations
Average accuracy 0.359 - security_studies
Average accuracy 0.418 - sociology
Average accuracy 0.560 - us_foreign_policy
Average accuracy 0.355 - virology
Average accuracy 0.474 - world_religions
Average accuracy 0.279 - math
Average accuracy 0.382 - health
Average accuracy 0.305 - physics
Average accuracy 0.540 - business
Average accuracy 0.370 - biology
Average accuracy 0.251 - chemistry
Average accuracy 0.405 - computer science
Average accuracy 0.323 - economics
Average accuracy 0.407 - engineering
Average accuracy 0.329 - philosophy
Average accuracy 0.446 - other
Average accuracy 0.426 - history
Average accuracy 0.399 - geography
Average accuracy 0.432 - politics
Average accuracy 0.435 - psychology
Average accuracy 0.410 - culture
Average accuracy 0.320 - law
------------
Average accuracy 0.319 - STEM
Average accuracy 0.345 - humanities
Average accuracy 0.402 - social sciences
Average accuracy 0.426 - other (business, health, misc.)
Average accuracy: 0.371
{'mmlu': 37.05}
mmlu: 37.05