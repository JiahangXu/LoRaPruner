prompt_mark 1-1
{'data_dir': 'data/mmlu', 'ntrain': 5, 'prompt_mark': '1-1', 'kwargs': {'model_name': 'llama', 'model_path': '/mnt/jiahang/LoRaPruner/llama_pruned_a100_5.4B_merged'}, 'args': Namespace(data_dir='data/mmlu', ntrain=5, prompt_mark='1-1', kwargs={'model_name': 'llama', 'model_path': '/mnt/jiahang/LoRaPruner/llama_pruned_a100_5.4B_merged'}), 'model': LlamaModel(model_path='/mnt/jiahang/LoRaPruner/llama_pruned_a100_5.4B_merged', max_input_length=2048, max_output_length=2, model=None, tokenizer=None, lora_path='', device='cuda', load_8bit=False, do_sample=False, use_template=False)}

  0%|          | 0/57 [00:00<?, ?it/s]/home/aisilicon/miniconda3/envs/llm-pruner/lib/python3.10/site-packages/transformers/tokenization_utils_base.py:1900: FutureWarning: The `use_auth_token` argument is deprecated and will be removed in v5 of Transformers. Please use `token` instead.
  warnings.warn(


Loading checkpoint shards:   0%|          | 0/3 [00:00<?, ?it/s][A/home/aisilicon/miniconda3/envs/llm-pruner/lib/python3.10/site-packages/torch/_utils.py:776: UserWarning: TypedStorage is deprecated. It will be removed in the future and UntypedStorage will be the only storage class. This should only matter to you if you are using storages directly.  To access UntypedStorage directly, use tensor.untyped_storage() instead of tensor.storage()
  return self.fget.__get__(instance, owner)()


Loading checkpoint shards:  33%|███▎      | 1/3 [00:04<00:09,  4.73s/it][A

Loading checkpoint shards:  67%|██████▋   | 2/3 [00:09<00:04,  4.57s/it][A

Loading checkpoint shards: 100%|██████████| 3/3 [00:12<00:00,  3.94s/it][A
Loading checkpoint shards: 100%|██████████| 3/3 [00:12<00:00,  4.12s/it]

  2%|▏         | 1/57 [01:02<58:11, 62.35s/it]
  4%|▎         | 2/57 [01:46<47:04, 51.35s/it]
  5%|▌         | 3/57 [03:00<55:52, 62.08s/it]
  7%|▋         | 4/57 [03:46<49:08, 55.64s/it]
  9%|▉         | 5/57 [05:17<59:06, 68.21s/it]
 11%|█         | 6/57 [06:11<54:00, 63.55s/it]
 12%|█▏        | 7/57 [06:54<47:14, 56.69s/it]
 14%|█▍        | 8/57 [07:57<47:53, 58.65s/it]
 16%|█▌        | 9/57 [08:41<43:15, 54.07s/it]
 18%|█▊        | 10/57 [09:55<47:12, 60.26s/it]
 19%|█▉        | 11/57 [10:33<41:06, 53.62s/it]
 21%|██        | 12/57 [11:04<35:03, 46.74s/it]
 23%|██▎       | 13/57 [12:07<37:55, 51.71s/it]
 25%|██▍       | 14/57 [13:00<37:21, 52.13s/it]
 26%|██▋       | 15/57 [13:50<36:00, 51.43s/it]
 28%|██▊       | 16/57 [16:28<57:05, 83.54s/it]
 30%|██▉       | 17/57 [17:28<50:48, 76.22s/it]
 32%|███▏      | 18/57 [18:02<41:19, 63.57s/it]
 33%|███▎      | 19/57 [20:09<52:25, 82.78s/it]
 35%|███▌      | 20/57 [21:11<47:13, 76.58s/it]
 37%|███▋      | 21/57 [21:53<39:43, 66.22s/it]
 39%|███▊      | 22/57 [24:58<59:18, 101.68s/it]
 40%|████      | 23/57 [25:59<50:45, 89.58s/it] 
 42%|████▏     | 24/57 [27:06<45:35, 82.88s/it]
 44%|████▍     | 25/57 [29:09<50:32, 94.77s/it]
 46%|████▌     | 26/57 [30:50<49:59, 96.75s/it]
 47%|████▋     | 27/57 [32:04<44:57, 89.92s/it]
 49%|████▉     | 28/57 [33:06<39:26, 81.60s/it]
 51%|█████     | 29/57 [36:42<56:47, 121.70s/it]
 53%|█████▎    | 30/57 [38:53<56:03, 124.58s/it]
 54%|█████▍    | 31/57 [42:54<1:09:08, 159.54s/it]
 56%|█████▌    | 32/57 [47:16<1:19:14, 190.19s/it]
 58%|█████▊    | 33/57 [48:16<1:00:27, 151.14s/it]
 60%|█████▉    | 34/57 [48:53<44:52, 117.05s/it]  
 61%|██████▏   | 35/57 [49:52<36:28, 99.47s/it] 
 63%|██████▎   | 36/57 [50:26<27:56, 79.85s/it]
 65%|██████▍   | 37/57 [51:21<24:05, 72.30s/it]
 67%|██████▋   | 38/57 [52:15<21:11, 66.91s/it]
 68%|██████▊   | 39/57 [52:42<16:27, 54.85s/it]
 70%|███████   | 40/57 [53:57<17:19, 61.14s/it]
 72%|███████▏  | 41/57 [54:27<13:44, 51.52s/it]
 74%|███████▎  | 42/57 [57:56<24:44, 98.97s/it]
 75%|███████▌  | 43/57 [59:59<24:46, 106.19s/it]
 77%|███████▋  | 44/57 [1:07:19<44:43, 206.40s/it]
 79%|███████▉  | 45/57 [1:09:39<37:16, 186.41s/it]
 81%|████████  | 46/57 [1:11:05<28:38, 156.19s/it]
 82%|████████▏ | 47/57 [1:13:17<24:48, 148.85s/it]
 84%|████████▍ | 48/57 [1:15:49<22:28, 149.81s/it]
 86%|████████▌ | 49/57 [1:44:21<1:22:28, 618.59s/it]
 88%|████████▊ | 50/57 [1:48:26<59:05, 506.56s/it]  
 89%|████████▉ | 51/57 [1:52:51<43:24, 434.13s/it]
 91%|█████████ | 52/57 [1:53:28<26:14, 314.81s/it]
 93%|█████████▎| 53/57 [1:57:19<19:19, 289.86s/it]
 95%|█████████▍| 54/57 [1:58:28<11:10, 223.54s/it]
 96%|█████████▋| 55/57 [1:59:01<05:32, 166.45s/it]
 98%|█████████▊| 56/57 [1:59:50<02:11, 131.01s/it]
100%|██████████| 57/57 [2:00:33<00:00, 104.68s/it]
100%|██████████| 57/57 [2:00:33<00:00, 126.90s/it]
Average accuracy 0.310 - abstract_algebra
Average accuracy 0.341 - anatomy
Average accuracy 0.316 - astronomy
Average accuracy 0.470 - business_ethics
Average accuracy 0.355 - clinical_knowledge
Average accuracy 0.389 - college_biology
Average accuracy 0.280 - college_chemistry
Average accuracy 0.340 - college_computer_science
Average accuracy 0.310 - college_mathematics
Average accuracy 0.301 - college_medicine
Average accuracy 0.294 - college_physics
Average accuracy 0.410 - computer_security
Average accuracy 0.332 - conceptual_physics
Average accuracy 0.263 - econometrics
Average accuracy 0.338 - electrical_engineering
Average accuracy 0.275 - elementary_mathematics
Average accuracy 0.206 - formal_logic
Average accuracy 0.340 - global_facts
Average accuracy 0.381 - high_school_biology
Average accuracy 0.217 - high_school_chemistry
Average accuracy 0.370 - high_school_computer_science
Average accuracy 0.394 - high_school_european_history
Average accuracy 0.394 - high_school_geography
Average accuracy 0.461 - high_school_government_and_politics
Average accuracy 0.305 - high_school_macroeconomics
Average accuracy 0.226 - high_school_mathematics
Average accuracy 0.290 - high_school_microeconomics
Average accuracy 0.278 - high_school_physics
Average accuracy 0.490 - high_school_psychology
Average accuracy 0.292 - high_school_statistics
Average accuracy 0.373 - high_school_us_history
Average accuracy 0.447 - high_school_world_history
Average accuracy 0.448 - human_aging
Average accuracy 0.344 - human_sexuality
Average accuracy 0.537 - international_law
Average accuracy 0.380 - jurisprudence
Average accuracy 0.387 - logical_fallacies
Average accuracy 0.312 - machine_learning
Average accuracy 0.388 - management
Average accuracy 0.560 - marketing
Average accuracy 0.360 - medical_genetics
Average accuracy 0.475 - miscellaneous
Average accuracy 0.355 - moral_disputes
Average accuracy 0.242 - moral_scenarios
Average accuracy 0.359 - nutrition
Average accuracy 0.412 - philosophy
Average accuracy 0.377 - prehistory
Average accuracy 0.316 - professional_accounting
Average accuracy 0.293 - professional_law
Average accuracy 0.404 - professional_medicine
Average accuracy 0.368 - professional_psychology
Average accuracy 0.391 - public_relations
Average accuracy 0.318 - security_studies
Average accuracy 0.453 - sociology
Average accuracy 0.490 - us_foreign_policy
Average accuracy 0.307 - virology
Average accuracy 0.497 - world_religions
Average accuracy 0.273 - math
Average accuracy 0.365 - health
Average accuracy 0.309 - physics
Average accuracy 0.499 - business
Average accuracy 0.383 - biology
Average accuracy 0.238 - chemistry
Average accuracy 0.357 - computer science
Average accuracy 0.294 - economics
Average accuracy 0.338 - engineering
Average accuracy 0.319 - philosophy
Average accuracy 0.425 - other
Average accuracy 0.397 - history
Average accuracy 0.394 - geography
Average accuracy 0.400 - politics
Average accuracy 0.425 - psychology
Average accuracy 0.410 - culture
Average accuracy 0.315 - law
------------
Average accuracy 0.308 - STEM
Average accuracy 0.333 - humanities
Average accuracy 0.384 - social sciences
Average accuracy 0.405 - other (business, health, misc.)
Average accuracy: 0.356
{'mmlu': 35.55}
mmlu: 35.55
