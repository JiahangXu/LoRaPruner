prompt_mark 0
{'data_dir': 'data/mmlu', 'ntrain': 5, 'prompt_mark': 0, 'kwargs': {'model_name': 'llama', 'model_path': 'a100_updatetokenizer_mark28-5_LoRaApplyAll_lr2e-4_bs8_AlpacaGPT4'}, 'args': Namespace(data_dir='data/mmlu', ntrain=5, prompt_mark=0, kwargs={'model_name': 'llama', 'model_path': 'a100_updatetokenizer_mark28-5_LoRaApplyAll_lr2e-4_bs8_AlpacaGPT4'}), 'model': LlamaModel(model_path='a100_updatetokenizer_mark28-5_LoRaApplyAll_lr2e-4_bs8_AlpacaGPT4', max_input_length=2048, max_output_length=2, model=None, tokenizer=None, lora_path='', device='cuda', load_8bit=False, do_sample=False, use_template=False)}

  0%|          | 0/57 [00:00<?, ?it/s]/home/aisilicon/miniconda3/envs/llm-pruner/lib/python3.10/site-packages/transformers/tokenization_utils_base.py:1900: FutureWarning: The `use_auth_token` argument is deprecated and will be removed in v5 of Transformers. Please use `token` instead.
  warnings.warn(


Loading checkpoint shards:   0%|          | 0/6 [00:00<?, ?it/s][A

Loading checkpoint shards:  17%|█▋        | 1/6 [00:02<00:12,  2.58s/it][A

Loading checkpoint shards:  33%|███▎      | 2/6 [00:05<00:10,  2.54s/it][A

Loading checkpoint shards:  50%|█████     | 3/6 [00:07<00:07,  2.57s/it][A

Loading checkpoint shards:  67%|██████▋   | 4/6 [00:10<00:05,  2.80s/it][A

Loading checkpoint shards:  83%|████████▎ | 5/6 [00:13<00:02,  2.57s/it][A

Loading checkpoint shards: 100%|██████████| 6/6 [00:14<00:00,  2.10s/it][A
Loading checkpoint shards: 100%|██████████| 6/6 [00:14<00:00,  2.37s/it]

  2%|▏         | 1/57 [01:22<1:17:20, 82.87s/it]
  4%|▎         | 2/57 [01:54<48:11, 52.57s/it]  
  5%|▌         | 3/57 [02:49<48:34, 53.98s/it]
  7%|▋         | 4/57 [03:24<41:00, 46.42s/it]
  9%|▉         | 5/57 [04:34<47:39, 54.98s/it]
 11%|█         | 6/57 [05:17<43:06, 50.71s/it]
 12%|█▏        | 7/57 [05:49<37:08, 44.58s/it]
 14%|█▍        | 8/57 [06:40<38:12, 46.78s/it]
 16%|█▌        | 9/57 [07:14<34:05, 42.61s/it]
 18%|█▊        | 10/57 [08:13<37:21, 47.69s/it]
 19%|█▉        | 11/57 [08:43<32:22, 42.23s/it]
 21%|██        | 12/57 [09:07<27:37, 36.84s/it]
 23%|██▎       | 13/57 [09:53<29:01, 39.58s/it]
 25%|██▍       | 14/57 [10:34<28:38, 39.96s/it]
 26%|██▋       | 15/57 [11:13<27:46, 39.67s/it]
 28%|██▊       | 16/57 [13:13<43:34, 63.77s/it]
 30%|██▉       | 17/57 [13:58<38:46, 58.17s/it]
 32%|███▏      | 18/57 [14:24<31:32, 48.52s/it]
 33%|███▎      | 19/57 [15:59<39:32, 62.43s/it]
 35%|███▌      | 20/57 [16:58<38:00, 61.63s/it]
 37%|███▋      | 21/57 [17:54<35:57, 59.92s/it]
 39%|███▊      | 22/57 [21:27<1:01:38, 105.66s/it]
 40%|████      | 23/57 [22:16<50:17, 88.74s/it]   
 42%|████▏     | 24/57 [23:10<43:08, 78.45s/it]
 44%|████▍     | 25/57 [24:46<44:35, 83.61s/it]
 46%|████▌     | 26/57 [26:05<42:32, 82.33s/it]
 47%|████▋     | 27/57 [27:04<37:40, 75.35s/it]
 49%|████▉     | 28/57 [27:52<32:19, 66.89s/it]
 51%|█████     | 29/57 [30:34<44:36, 95.59s/it]
 53%|█████▎    | 30/57 [32:20<44:25, 98.71s/it]
 54%|█████▍    | 31/57 [36:43<1:04:09, 148.06s/it]
 56%|█████▌    | 32/57 [40:52<1:14:18, 178.34s/it]
 58%|█████▊    | 33/57 [41:36<55:12, 138.04s/it]  
 60%|█████▉    | 34/57 [42:04<40:14, 104.96s/it]
 61%|██████▏   | 35/57 [42:48<31:48, 86.73s/it] 
 63%|██████▎   | 36/57 [43:15<24:03, 68.75s/it]
 65%|██████▍   | 37/57 [43:58<20:22, 61.13s/it]
 67%|██████▋   | 38/57 [44:40<17:29, 55.22s/it]
 68%|██████▊   | 39/57 [44:59<13:19, 44.40s/it]
 70%|███████   | 40/57 [45:58<13:50, 48.85s/it]
 72%|███████▏  | 41/57 [46:21<10:58, 41.15s/it]
 74%|███████▎  | 42/57 [48:52<18:30, 74.01s/it]
 75%|███████▌  | 43/57 [50:30<18:56, 81.20s/it]
 77%|███████▋  | 44/57 [55:57<33:32, 154.83s/it]
 79%|███████▉  | 45/57 [57:43<28:01, 140.13s/it]
 81%|████████  | 46/57 [58:46<21:26, 116.99s/it]
 82%|████████▏ | 47/57 [1:00:27<18:44, 112.45s/it]
 84%|████████▍ | 48/57 [1:02:30<17:19, 115.47s/it]
 86%|████████▌ | 49/57 [1:34:35<1:27:47, 658.38s/it]
 88%|████████▊ | 50/57 [1:38:02<1:00:59, 522.85s/it]
 89%|████████▉ | 51/57 [1:41:14<42:21, 423.64s/it]  
 91%|█████████ | 52/57 [1:41:41<25:22, 304.57s/it]
 93%|█████████▎| 53/57 [1:44:51<18:01, 270.31s/it]
 95%|█████████▍| 54/57 [1:45:44<10:15, 205.05s/it]
 96%|█████████▋| 55/57 [1:46:09<05:02, 151.12s/it]
 98%|█████████▊| 56/57 [1:46:46<01:56, 116.73s/it]
100%|██████████| 57/57 [1:47:16<00:00, 90.85s/it] 
100%|██████████| 57/57 [1:47:16<00:00, 112.92s/it]
Average accuracy 0.320 - abstract_algebra
Average accuracy 0.489 - anatomy
Average accuracy 0.349 - astronomy
Average accuracy 0.460 - business_ethics
Average accuracy 0.430 - clinical_knowledge
Average accuracy 0.368 - college_biology
Average accuracy 0.280 - college_chemistry
Average accuracy 0.360 - college_computer_science
Average accuracy 0.330 - college_mathematics
Average accuracy 0.353 - college_medicine
Average accuracy 0.235 - college_physics
Average accuracy 0.580 - computer_security
Average accuracy 0.366 - conceptual_physics
Average accuracy 0.316 - econometrics
Average accuracy 0.441 - electrical_engineering
Average accuracy 0.257 - elementary_mathematics
Average accuracy 0.222 - formal_logic
Average accuracy 0.320 - global_facts
Average accuracy 0.445 - high_school_biology
Average accuracy 0.305 - high_school_chemistry
Average accuracy 0.370 - high_school_computer_science
Average accuracy 0.521 - high_school_european_history
Average accuracy 0.460 - high_school_geography
Average accuracy 0.596 - high_school_government_and_politics
Average accuracy 0.392 - high_school_macroeconomics
Average accuracy 0.263 - high_school_mathematics
Average accuracy 0.403 - high_school_microeconomics
Average accuracy 0.205 - high_school_physics
Average accuracy 0.530 - high_school_psychology
Average accuracy 0.241 - high_school_statistics
Average accuracy 0.529 - high_school_us_history
Average accuracy 0.599 - high_school_world_history
Average accuracy 0.538 - human_aging
Average accuracy 0.473 - human_sexuality
Average accuracy 0.595 - international_law
Average accuracy 0.546 - jurisprudence
Average accuracy 0.423 - logical_fallacies
Average accuracy 0.402 - machine_learning
Average accuracy 0.437 - management
Average accuracy 0.654 - marketing
Average accuracy 0.480 - medical_genetics
Average accuracy 0.573 - miscellaneous
Average accuracy 0.445 - moral_disputes
Average accuracy 0.240 - moral_scenarios
Average accuracy 0.431 - nutrition
Average accuracy 0.537 - philosophy
Average accuracy 0.478 - prehistory
Average accuracy 0.340 - professional_accounting
Average accuracy 0.347 - professional_law
Average accuracy 0.478 - professional_medicine
Average accuracy 0.402 - professional_psychology
Average accuracy 0.555 - public_relations
Average accuracy 0.437 - security_studies
Average accuracy 0.522 - sociology
Average accuracy 0.620 - us_foreign_policy
Average accuracy 0.392 - virology
Average accuracy 0.591 - world_religions
Average accuracy 0.268 - math
Average accuracy 0.449 - health
Average accuracy 0.303 - physics
Average accuracy 0.558 - business
Average accuracy 0.421 - biology
Average accuracy 0.297 - chemistry
Average accuracy 0.427 - computer science
Average accuracy 0.384 - economics
Average accuracy 0.441 - engineering
Average accuracy 0.365 - philosophy
Average accuracy 0.495 - other
Average accuracy 0.528 - history
Average accuracy 0.460 - geography
Average accuracy 0.532 - politics
Average accuracy 0.462 - psychology
Average accuracy 0.503 - culture
Average accuracy 0.376 - law
------------
Average accuracy 0.331 - STEM
Average accuracy 0.401 - humanities
Average accuracy 0.462 - social sciences
Average accuracy 0.480 - other (business, health, misc.)
Average accuracy: 0.418
{'mmlu': 41.79}
mmlu: 41.79
